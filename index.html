<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mi Refugio ‚Äî Bienestar emocional</title>
  <meta name="description" content="Landing informativa de Mi Refugio. Descubre funciones, equipo, emergencias en Chile y descarga la app.">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" href="/favicon.ico">
  <style>
    :root{
      --mr-blue:#1e40af;   /* azul */
      --mr-sky:#60a5fa;    /* celeste */
      --mr-sky-2:#dbeafe;  /* celeste claro */
      --mr-ink:#0f172a;    /* texto fuerte */
    }
    body{background:linear-gradient(180deg, #ffffff 0%, var(--mr-sky-2) 100%);}
    .navbar{box-shadow:0 6px 20px rgba(2,6,23,.08)}
    .btn-mr{background:var(--mr-blue); color:#fff}
    .btn-mr:hover{background:#17348a; color:#fff}
    .btn-outline-mr{border-color:var(--mr-blue); color:var(--mr-blue)}
    .btn-outline-mr:hover{background:var(--mr-blue); color:#fff}
    .shadow-soft{box-shadow:0 12px 30px rgba(2,6,23,.08)}
    .badge-step{display:inline-flex; align-items:center; justify-content:center; width:44px; height:44px; border-radius:.75rem; background:#fff; border:2px solid var(--mr-blue); color:var(--mr-blue); font-weight:800;}
    .section-title{color:var(--mr-blue)}
    .brand-logo{width:42px; height:42px; object-fit:contain}
    .avatar{width:96px; height:96px; object-fit:cover; border-radius:50%; border:2px solid rgba(15,23,42,.1)}
    .gov-logo{max-height:52px; object-fit:contain}
    .card-emg h5{color:var(--mr-blue)}
    footer{background:#fff}
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="navbar navbar-expand-lg bg-white sticky-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="#inicio">
        <img src="img/LOGO OFICIAL.png" class="brand-logo" alt="Logo Mi Refugio">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav" aria-expanded="false" aria-label="Abrir men√∫">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="#que-es">¬øQu√© es?</a></li>
          <li class="nav-item"><a class="nav-link" href="#como-usar">C√≥mo usar</a></li>
          <li class="nav-item"><a class="nav-link" href="#incluye">Incluye</a></li>
          <li class="nav-item"><a class="nav-link" href="#equipo">Equipo</a></li>
          <li class="nav-item"><a class="nav-link" href="#emergencias">Emergencias</a></li>
          <li class="nav-item"><a class="nav-link" href="#descargas">Descargas</a></li>
          <li class="nav-item"><a class="nav-link" href="#contacto">Contacto</a></li>
          <li class="nav-item"><a class="nav-link" href="#donaciones">Donaciones</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <main id="inicio" class="py-5">
    <!-- HERO -->
    <section class="py-5">
      <div class="container">
        <div class="row align-items-center g-4">
          <div class="col-lg-6">
            <h1 class="display-5 fw-bold text-dark">Bienestar emocional, a un toque</h1>
            <p class="lead text-secondary">Mi Refugio ofrece <strong>diario emocional</strong>, <strong>ejercicios de mindfulness</strong> y un <strong>chatbot de contenci√≥n</strong> para acompa√±arte en el d√≠a a d√≠a.</p>
            <div class="d-flex gap-2">
              <a class="btn btn-mr btn-lg" href="#descargas">Descargar App</a>
              <a class="btn btn-outline-mr btn-lg" href="#que-es">Saber m√°s</a>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="card shadow-soft border-0">
              <div class="card-body p-4">
                <img src="img/LOGO OFICIAL.png" alt="Logo grande Mi Refugio" class="d-block mx-auto" style="max-height:200px">
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ¬øQU√â ES? -->
    <section id="que-es" class="py-4">
      <div class="container">
        <div class="card shadow-soft border-0">
          <div class="card-body p-4 p-md-5">
            <h2 class="section-title mb-3">¬øQu√© es <em>Mi Refugio</em>?</h2>
            <p class="mb-0 text-secondary">Proyecto universitario orientado a <strong>apoyo y educaci√≥n emocional</strong> en Chile. Promueve un espacio <strong>seguro, accesible y emp√°tico</strong> con enfoque de privacidad por dise√±o y accesibilidad.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- C√ìMO USAR -->
    <section id="como-usar" class="py-4">
      <div class="container">
        <div class="card shadow-soft border-0">
          <div class="card-body p-4 p-md-5">
            <h2 class="section-title mb-4">¬øC√≥mo usar la APP?</h2>
            <div class="row g-4">
              <div class="col-md-6">
                <div class="d-flex gap-3">
                  <span class="badge-step">1</span>
                  <div>
                    <h5 class="mb-1">Descarga la app</h5>
                    <ul class="text-secondary mb-0">
                      <li>Disponible en Google Play y App Store.</li>
                      <li>Tambi√©n puedes escanear el c√≥digo QR.</li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="d-flex gap-3">
                  <span class="badge-step">2</span>
                  <div>
                    <h5 class="mb-1">Crea tu perfil</h5>
                    <ul class="text-secondary mb-0">
                      <li>Reg√≠strate con correo o cuenta social.</li>
                      <li>Tus datos son privados y est√°n bajo tu control.</li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="d-flex gap-3">
                  <span class="badge-step">3</span>
                  <div>
                    <h5 class="mb-1">Registra tu estado emocional</h5>
                    <ul class="text-secondary mb-0">
                      <li>Elige emociones y agrega notas para m√°s precisi√≥n.</li>
                      <li>Visualiza tu historial y patrones.</li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="d-flex gap-3">
                  <span class="badge-step">4</span>
                  <div>
                    <h5 class="mb-1">Recibe apoyo y sugerencias</h5>
                    <ul class="text-secondary mb-0">
                      <li>Ejercicios breves de mindfulness.</li>
                      <li>Consejos personalizados.</li>
                      <li>Chatbot de contenci√≥n (no terapia).</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div> <!-- row -->
          </div>
        </div>
      </div>
    </section>

    <!-- INCLUYE -->
    <section id="incluye" class="py-4">
      <div class="container">
        <h2 class="section-title mb-3">¬øQu√© incluye la app?</h2>
        <div class="row g-3">
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-soft border-0">
              <div class="card-body">
                <h5 class="card-title">Diario emocional</h5>
                <p class="card-text text-secondary">Registra estados, notas y observa tu progreso con visualizaciones simples.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-soft border-0">
              <div class="card-body">
                <h5 class="card-title">Chatbot de apoyo</h5>
                <p class="card-text text-secondary">Contenci√≥n inicial con mensajes claros de alcance y derivaci√≥n.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-soft border-0">
              <div class="card-body">
                <h5 class="card-title">Mindfulness y respiraci√≥n</h5>
                <p class="card-text text-secondary">Rutinas cortas para bajar la ansiedad y reconectar con el presente.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-soft border-0">
              <div class="card-body">
                <h5 class="card-title">Recursos y redes de ayuda</h5>
                <p class="card-text text-secondary">Directorio confiable de l√≠neas de apoyo y organizaciones.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-soft border-0">
              <div class="card-body">
                <h5 class="card-title">Privacidad por dise√±o</h5>
                <p class="card-text text-secondary">Permisos m√≠nimos, cifrado y control del usuario sobre sus datos.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-soft border-0">
              <div class="card-body">
                <h5 class="card-title">Recomendaciones con IA</h5>
                <p class="card-text text-secondary">Sugerencias de h√°bitos y actividades seg√∫n tus registros.</p>
              </div>
            </div>
          </div>
        </div> <!-- row -->
      </div>
    </section>

    <!-- EQUIPO -->
    <section id="equipo" class="py-4">
      <div class="container">
        <h2 class="section-title mb-3">¬øQui√©nes somos?</h2>
        <div class="row g-3">
          <div class="col-sm-6 col-lg-3">
            <div class="card text-center shadow-soft border-0">
              <div class="card-body">
                <img class="avatar mb-2" src="img/mateo.flores.jpg" alt="Mateo Flores">
                <h6 class="mb-0">Mateo Flores</h6>
                <small class="text-secondary">Jefe de Proyecto</small>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-lg-3">
            <div class="card text-center shadow-soft border-0">
              <div class="card-body">
                <img class="avatar mb-2" src="img/pierre.salas.jpg" alt="Pierre Salas">
                <h6 class="mb-0">Pierre Salas</h6>
                <small class="text-secondary">Jefe de Desarrollo</small>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-lg-3">
            <div class="card text-center shadow-soft border-0">
              <div class="card-body">
                <img class="avatar mb-2" src="img/liti.png" alt="Mat√≠as Rubilar">
                <h6 class="mb-0">Mat√≠as Rubilar</h6>
                <small class="text-secondary">Analista de Calidad</small>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-lg-3">
            <div class="card text-center shadow-soft border-0">
              <div class="card-body">
                <img class="avatar mb-2" src="img/isaias.veloz.jpg" alt="Isaias Veloz">
                <h6 class="mb-0">Isaias Veloz</h6>
                <small class="text-secondary">Arquitecto de Software</small>
              </div>
            </div>
          </div>
        </div> <!-- row -->
      </div>
    </section>

    <!-- EMERGENCIAS CHILE -->
    <section id="emergencias" class="py-4">
      <div class="container">
        <div class="card shadow-soft border-0">
          <div class="card-body p-4 p-md-5">
            <div class="d-flex align-items-center gap-3 mb-3 flex-wrap">
              <img src="img/MINSAL.png" alt="Gobierno de Chile" class="gov-logo">
              <h2 class="section-title mb-0">Emergencias psicol√≥gicas en Chile</h2>
            </div>
            <div class="row g-3">
              <div class="col-md-6 col-lg-4">
                <div class="card card-emg h-100 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title">*4141 ‚Äî Prevenci√≥n del suicidio</h5>
                    <p class="text-secondary mb-0">‚ÄúNo est√°s solo, no est√°s sola‚Äù. Atenci√≥n <strong>24/7</strong>, gratuita y confidencial por profesionales.</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-lg-4">
                <div class="card card-emg h-100 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title">600 360 7777 ‚Äî Salud Responde (MINSAL)</h5>
                    <p class="text-secondary mb-0">Orientaci√≥n de salud <strong>24/7</strong> y derivaci√≥n a la red p√∫blica cuando corresponda.</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-lg-4">
                <div class="card card-emg h-100 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title">1455 ‚Äî Violencias de g√©nero (SernamEG)</h5>
                    <p class="text-secondary mb-0">Atenci√≥n gratuita para v√≠ctimas o testigos. <strong>08:00‚Äì24:00</strong> todos los d√≠as.</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-lg-4">
                <div class="card card-emg h-100 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title">Emergencias generales</h5>
                    <p class="text-secondary mb-0"><strong>131</strong> SAMU ¬∑ <strong>132</strong> Bomberos ¬∑ <strong>133</strong> Carabineros ¬∑ <strong>134</strong> PDI.</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-lg-4">
                <div class="card card-emg h-100 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title">800 200 818 ‚Äî Fono Infancia</h5>
                    <p class="text-secondary mb-0">Apoyo psicol√≥gico en crianza de ni√±as, ni√±os y adolescentes.</p>
                  </div>
                </div>
              </div>
            </div>
            <p class="mt-3 small text-secondary">Aviso: Mi Refugio ofrece contenci√≥n y educaci√≥n. <strong>No reemplaza</strong> atenci√≥n psicol√≥gica o m√©dica. En riesgo inminente, llama al <strong>131</strong> o acude a urgencias.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- DESCARGAS -->
    <section id="descargas" class="py-4">
      <div class="container">
        <div class="card shadow-soft border-0">
          <div class="card-body p-4">
            <h2 class="section-title mb-3">Descarga la app</h2>
            <p class="text-secondary">Pr√≥ximamente en tiendas.</p>
            <div class="d-flex flex-wrap gap-2">
              <a class="btn btn-outline-mr" href="#" target="_blank" rel="noopener">Google Play</a>
              <a class="btn btn-outline-mr" href="#" target="_blank" rel="noopener">App Store</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACTO -->
    <section id="contacto" class="py-4">
      <div class="container" style="max-width: 960px;">
        <div class="card shadow-soft border-0">
          <div class="card-body p-4">
            <h2 class="section-title mb-3">Preguntas y sugerencias</h2>
            <!-- ALERTAS -->
            <div id="form-alert" class="d-none"></div>
            <!-- FORM -->
            <form id="form_contac" class="row g-3" novalidate>
              <div class="col-md-6">
                <label for="name" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="name" name="name" required placeholder="Tu nombre">
                <div class="invalid-feedback">Ingresa tu nombre.</div>
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">Correo</label>
                <input type="email" class="form-control" id="email" name="email" required placeholder="tu@correo.com">
                <div class="invalid-feedback">Ingresa un correo v√°lido.</div>
              </div>
              <div class="col-md-6">
                <label for="type" class="form-label">Tipo</label>
                <select id="type" name="type" class="form-select" required>
                <option value="" selected disabled>Selecciona una opci√≥n</option>
                <option value="pregunta">Pregunta</option>
                <option value="sugerencia">Sugerencia</option>
                <option value="otro">Otro</option>
                </select>
                <div class="invalid-feedback">Selecciona el tipo de mensaje.</div>
              </div>
              <div class="col-12">
                <label for="message" class="form-label">Mensaje</label>
                <textarea id="message" name="message" class="form-control" rows="5" minlength="10" maxlength="1000" required placeholder="Cu√©ntanos en qu√© te podemos ayudar"></textarea>
                <div class="form-text">M√≠nimo 10 caracteres.</div>
                <div class="invalid-feedback">Ingresa un mensaje (‚â• 10 caracteres).</div>
              </div>
              <!-- reCAPTCHA v2 (checkbox) -->
              <div class="col-12">
                <div class="g-recaptcha" data-sitekey="6LdvnN8rAAAAAHqkv8JSH0SnUMpuyVUr31Ql0QUa"></div>
                <div class="form-text">Protegido por reCAPTCHA.</div>
              </div>
              <div class="col-12 d-flex gap-2">
                <button type="submit" class="btn btn-mr">Enviar</button>
                <button type="reset" class="btn btn-outline-secondary">Limpiar</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="py-4 border-top">
    <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center gap-2">
      <p class="mb-0 small text-secondary">¬© <span id="year"></span> Mi Refugio</p>
      <p class="mb-0 small text-secondary">Fuente de tel√©fonos: Gobierno de Chile (programas p√∫blicos).</p>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- reCAPTCHA -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>

  <!-- L√≥gica del formulario (Apps Script) -->
  <script>
  // A√±o din√°mico en el footer (aseg√∫rate de tener <span id="year"></span> en tu footer)
  (document.getElementById('year')||{}).textContent = new Date().getFullYear();

  // Helpers de alertas
  function showAlert(kind, text) {
    const host = document.getElementById('form-alert');
    host.className = '';
    host.innerHTML = `
      <div class="alert alert-${kind} alert-dismissible fade show" role="alert">
        ${text}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
      </div>`;
  }
  function hideAlert() {
    const host = document.getElementById('form-alert');
    host.className = 'd-none';
    host.innerHTML = '';
  }

  const form = document.getElementById('form_contac');

  // üîó TU Web App URL (debe terminar en /exec)
  // Ejemplo: 'https://script.google.com/macros/s/AKfycbxxxxxxxxxxxx/exec'
  const endpoint = 'https://script.google.com/macros/s/AKfycbyvonDiYniT9OqtnPH9VujqrrJ8SPubOdFjY4VaBB4mv_3DOrg3eAN72zamC6m6Dxy1sg/exec';

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    hideAlert();

    // Validaci√≥n front
    const msg = document.getElementById('message').value.trim();
    if (!form.checkValidity() || msg.length < 10) {
      form.classList.add('was-validated');
      showAlert('warning', 'Revisa los campos: el mensaje debe tener al menos 10 caracteres.');
      return;
    }

    // Token de reCAPTCHA (textarea oculto)
    const recaptchaToken = document.querySelector('textarea[name="g-recaptcha-response"]')?.value || '';
    if (!recaptchaToken) {
      showAlert('warning', 'Completa el reCAPTCHA para poder enviar.');
      return;
    }

    // üöö Env√≠o como FormData (NO pongas Content-Type)
    const fd = new FormData();
    fd.append('name',    document.getElementById('name').value.trim());
    fd.append('email',   document.getElementById('email').value.trim());
    fd.append('type',    document.getElementById('type').value);
    fd.append('message', msg);
    fd.append('recaptcha', recaptchaToken);

    try {
      const res = await fetch(endpoint, { method: 'POST', body: fd });
      // Apps Script siempre responde 200; el estado viene en el body
      let data = {};
      try { data = await res.json(); } catch { data = {}; }

      if (!data.ok) {
        const errMsg = data.error || 'No pudimos enviar tu mensaje. Intenta nuevamente.';
        showAlert('danger', `Error: ${errMsg}`);
        return;
      }

      showAlert('success', '¬°Gracias! Tu mensaje fue enviado correctamente.');
      form.reset();
      form.classList.remove('was-validated');
      if (window.grecaptcha) grecaptcha.reset();
    } catch (err) {
      console.error(err);
      showAlert('danger', 'No pudimos conectar con el servicio. Verifica tu conexi√≥n e int√©ntalo otra vez.');
    }
  });
</script>
</body>
</html>
